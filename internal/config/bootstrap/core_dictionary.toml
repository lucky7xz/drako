# Drako Core Command Dictionary
# This file maps the 'name' of a command to its platform-specific implementation.


# ==================================================================
# ==================================================================

["â¬†ï¸ System Update"]
linux_debian = "sudo apt update && sudo apt upgrade"
linux_arch = "sudo pacman -Syu"
linux_fedora = "sudo dnf upgrade"
macos = "brew upgrade"
windows = "winget upgrade --all"

["Clean Packages"]
linux_debian = "sudo apt autoremove"
linux_arch = "sudo pacman -Sc"
linux_fedora = "sudo dnf autoremove"
macos = "brew cleanup"
windows = "echo 'Windows handles cleanup automatically'"


# ==================================================================
# ==================================================================

["Virus Scan (Home)"]
# clamscan: The command-line virus scanner itself.

# -r (Recursive): Tells the scanner to not just look at the files inside your Home folder, but to go into every sub-folder (Documents, Downloads, Desktop, etc.) and scan those too.

# --bell: Triggers a system sound (beep) if a virus is found. Useful if you want to leave the scan running in the background and just listen for alerts.

# -i (Infected): This stands for "Infected only." By default, clamscan prints every single safe file it checks, which creates a messy wall of text. This flag forces it to stay silent unless it finds a virus.

# $HOME: This is a variable that points to your current user's home directory (e.g., /home/username or /Users/username).

linux_generic = """
# Check if ClamAV is installed first
if ! command -v freshclam &> /dev/null || ! command -v clamscan &> /dev/null; then
    echo "âŒ Error: ClamAV is not installed. Run the install command from Cell [C-0] first."
    sleep 1
    exit 1
fi

echo "ðŸ›¡ï¸  Initiating Security Protocol..."
echo "-----------------------------------"

# Step 1: Update
echo "ðŸ“¦ [1/2] Updating Virus Definitions..."
sudo freshclam || echo "âš ï¸  Update had warnings, proceeding to scan anyway..."

# Step 2: Scan
echo "-----------------------------------"
echo "ðŸ” [2/2] Scanning $HOME recursively..."
echo "â„¹ï¸  NOTE: The scanner is in 'Infected-Only' mode."
echo "â„¹ï¸  NOTE: In this mode, silence is GOOD. You will only see output if a threat is detected."
echo "â³  Scanning now (this may take several minutes)..."

# Run scan
clamscan -r --bell -i "$HOME"

echo "-----------------------------------"
echo "âœ… Scan complete."
"""


macos = "echo 'No virus scanning needed by default'"
windows = "Start-Process 'C:\\Program Files\\Windows Defender\\MpCmdRun.exe' -ArgumentList '-Scan -ScanType 2'"
# ==================================================================
# ==================================================================

["ðŸ‘€ Process Monitor"]
linux_generic = """
btop 2>/dev/null || {
    echo "btop not available. Defaulting to top..."
    top
}
"""

# MacOS
# Logic: Falls back to 'top -o cpu' which is better for Mac
macos = """
btop 2>/dev/null || {
    echo "btop not available. Defaulting to top..."
    top -o cpu
}
"""
windows = "taskmgr"


# ==================================================================
# ==================================================================

[" ðŸ”Ž File Finder"]
linux_generic = "fzf --preview 'head -n 50 {}' --preview-window=right:50%:wrap --border --header 'ðŸ”Ž START TYPING TO SEARCH...'"
macos = "fzf --preview 'head -n 50 {}' --preview-window=right:50%:wrap --border --header 'ðŸ”Ž START TYPING TO SEARCH...'"
windows = "gci -Recurse | Where-Object { ! $_.PSIsContainer } | Out-GridView"

["ðŸŒ Bandwidth"]
linux_generic = """
bmon 2>/dev/null || {
    echo "bmon not available. Starting fallback monitor..."
    sleep 1
    while true; do
        clear
        cat /proc/net/dev | awk '
        NR>2 {
            # Capture stats
            recv[$1]=$2; trans[$1]=$10;
        }
        END {
            # Header
            printf "%-10s %15s %15s\\n", "IFACE", "RX (Bytes)", "TX (Bytes)"
            print "---------------------------------------------"
            # Print (Note: This is a simplified snapshot view)
            for (i in recv) {
                printf "%-10s %15s %15s\\n", i, recv[i], trans[i]
            }
        }'
        echo ""
        echo "Update: 1s | Press Ctrl+C to stop"
        sleep 1
    done
}"""
macos = "nettop -P -L 1"
windows = "typeperf \"\\Network Interface(*)\\Bytes Total/sec\""

["System Info"]
linux_generic = """
neofetch 2>/dev/null || {
    echo "neofetch not available. Defaulting to lshw..."
    lshw -short
}
"""
macos = "system_profiler SPSoftwareDataType SPDetailLevel=mini"
windows = "systeminfo"

["Disk Usage"]
linux_generic = """
duf 2>/dev/null || {
    echo "duf not available. Defaulting to du..."
    du -h -d 1
}
"""
macos = "du -h -d 1"
windows = "drako internal open-url ms-settings:storage"

["Weather"]
linux_generic = "curl wttr.in"
macos = "curl wttr.in"
windows = "curl wttr.in"


# ==================================================================
# ==================================================================

["Install common tools"]
linux_debian = "sudo apt install btop bmon neofetch clamav fzf duf"
linux_arch = "sudo pacman -S btop bmon neofetch clamav fzf duf"
linux_fedora = "sudo dnf install btop bmon neofetch clamav fzf duf"
macos = "brew install btop bmon neofetch fzf duf"
windows = "winget install btop bmon neofetch fzf duf"

["Install micro"]
linux_debian = "sudo apt install micro"
linux_arch = "sudo pacman -S micro"
linux_fedora = "sudo dnf install micro"
macos = "brew install micro"
windows = "winget install micro"

["Set micro as EDITOR"]
linux_generic = "echo 'export EDITOR=micro' >> ~/.bashrc && echo \"Alias added to ~/.bashrc. Restart shell to use 'x'.\""
macos = "echo 'export EDITOR=micro' >> ~/.zshrc && echo \"Alias added to ~/.zshrc. Restart shell to use 'x'.\""
windows = "setx EDITOR micro"

["ðŸƒ Summon 'ggml' Command Deck"]
linux_generic = "drako summon https://github.com/lucky7xz/ggml-deck.git"
macos = "drako summon https://github.com/lucky7xz/ggml-deck.git"
windows = "drako summon https://github.com/lucky7xz/ggml-deck.git"

["ðŸƒ Summon '101 Series' Command Deck"]
linux_generic = "drako summon https://github.com/lucky7xz/101-deck.git"
macos = "drako summon https://github.com/lucky7xz/101-deck.git"
windows = "drako summon https://github.com/lucky7xz/101-deck.git"

["ðŸƒ Summon Private Deck"]
linux_generic = '''
echo "Enter GitHub Username:"
read username
echo "Enter Repository Name:"
read reponame
echo "Summoning from git@github.com:$username/$reponame.git..."
drako summon "git@github.com:$username/$reponame.git"
'''
macos = '''
echo "Enter GitHub Username:"
read username
echo "Enter Repository Name:"
read reponame
echo "Summoning from git@github.com:$username/$reponame.git..."
drako summon "git@github.com:$username/$reponame.git"
'''
windows = '''
$username = Read-Host -Prompt "Enter GitHub Username"
$reponame = Read-Host -Prompt "Enter Repository Name"
Write-Host "Summoning from git@github.com:$username/$reponame.git..."
drako summon "git@github.com:$username/$reponame.git"
'''

["ðŸ“œ Open Shell Config"]
linux_generic = "$EDITOR ~/.bashrc"
macos = "$EDITOR ~/.zshrc"
windows = "drako open $PROFILE"


# ==================================================================
# ==================================================================

["âš™ï¸  Edit config.toml"]
linux_generic = "$EDITOR ~/.config/drako/config.toml"

macos = "$EDITOR ~/.config/drako/config.toml"
windows = "drako open %APPDATA%\\drako\\config.toml"

["ðŸ“ Browse config dir"]
linux_generic = "drako open ~/.config/drako"
macos = "drako open ~/.config/drako"
windows = "drako open %APPDATA%\\drako"

["ðŸ“œ Open Logs"]
linux_generic = "$EDITOR ~/.config/drako/drako.log"
macos = "$EDITOR ~/.config/drako/drako.log"
windows = "drako open %APPDATA%\\drako\\drako.log"

["â„¹ï¸  Open Pivots"]
linux_generic = "$EDITOR ~/.config/drako/pivot.toml"
macos = "$EDITOR ~/.config/drako/pivot.toml"
windows = "drako open %APPDATA%\\drako\\pivot.toml"

["Go Version"]
linux_generic = "go version"
macos = "go version"
windows = "go version"  

["Alias x=drako"]
linux_generic = '''
echo "alias x='~/go/bin/drako'" >> ~/.bashrc
echo "Alias added to ~/.bashrc. Restart shell to use 'x'."
'''
macos = '''
echo "alias x='~/go/bin/drako'" >> ~/.zshrc
echo "Alias added. Restart shell to use 'x'."
'''
windows = '''
echo 'Function x { & "$env:USERPROFILE\go\bin\drako.exe" }' >> $PROFILE
'''

["Add go/bin to PATH"]

linux_generic = '''
echo 'export PATH=$PATH:~/go/bin' >> ~/.bashrc
echo 'export PATH=$PATH:/usr/local/go/bin' >> ~/.bashrc
echo "Path added to ~/.bashrc. Restart shell to take effect."
'''

acos = '''
echo 'export PATH=$PATH:~/go/bin' >> ~/.zshrc
echo 'export PATH=$PATH:/usr/local/go/bin' >> ~/.zshrc
echo "Path added to ~/.zshrc. Restart shell to take effect."
'''

windows = '''
Add-Content $PROFILE '$env:PATH += ";$env:USERPROFILE\go\bin"'
Add-Content $PROFILE '$env:PATH += ";C:\Program Files\Go\bin"'
Write-Host "Path added to PowerShell Profile. Restart shell to take effect."
'''
