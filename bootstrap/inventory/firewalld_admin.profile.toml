# drako Profile: firewalld Administration
# A toolkit for managing firewalld, the default firewall on RHEL-based systems.

# ┌─ Grid Dimensions ──────────────────────────────┐
x = 2
y = 2
# └────────────────────────────────────────────────┘

# ┌─ Control & Status (A,0) ───────────────────────┐
[[commands]]
name = "⚙️ Control & Status"
col = "A"
row = 0

[[commands.items]]
name = "Install firewalld"
description = "Installs firewalld on RHEL/Rocky."
command = "sudo dnf install -y firewalld"
auto_close_execution = false

[[commands.items]]
name = "▶️ Start & Enable"
description = "Start and enable the firewalld service."
command = "sudo systemctl enable --now firewalld"
auto_close_execution = false

[[commands.items]]
name = "📊 State"
description = "Check if the firewall is running."
command = "sudo firewall-cmd --state"
auto_close_execution = false

[[commands.items]]
name = "📋 List All Rules"
description = "List all rules in the default zone."
command = "sudo firewall-cmd --list-all"
auto_close_execution = false

[[commands.items]]
name = "⚡ Reload Firewall"
description = "Reload firewall to apply permanent rules."
command = "sudo firewall-cmd --reload"
auto_close_execution = false

# ┌─ Runtime Rules (B,0) ──────────────────────────┐
[[commands]]
name = "🛠️ Runtime Rules (Temporary)"
col = "B"
row = 0

[[commands.items]]
name = "Add Service"
description = "Allow a predefined service (e.g., http, ssh)."
command = "printf 'Enter service name to allow: '; read -r srv && sudo firewall-cmd --add-service=\"$srv\""
auto_close_execution = false

[[commands.items]]
name = "Add Port"
description = "Allow a specific port and protocol."
command = "printf 'Enter port/protocol (e.g., 8080/tcp): '; read -r port && sudo firewall-cmd --add-port=\"$port\""
auto_close_execution = false

[[commands.items]]
name = "Remove Service"
description = "Remove a service."
command = "printf 'Enter service name to remove: '; read -r srv && sudo firewall-cmd --remove-service=\"$srv\""
auto_close_execution = false

[[commands.items]]
name = "Remove Port"
description = "Remove a port."
command = "printf 'Enter port/protocol to remove: '; read -r port && sudo firewall-cmd --remove-port=\"$port\""
auto_close_execution = false

# ┌─ Permanent Rules (A,1) ────────────────────────┐
[[commands]]
name = "💾 Permanent Rules"
col = "A"
row = 1

[[commands.items]]
name = "Add Service"
description = "Permanently allow a service."
command = "printf 'Enter service name: '; read -r srv && sudo firewall-cmd --add-service=\"$srv\" --permanent && echo 'Run Reload to apply.'"
auto_close_execution = false

[[commands.items]]
name = "Add Port"
description = "Permanently allow a port."
command = "printf 'Enter port/protocol: '; read -r port && sudo firewall-cmd --add-port=\"$port\" --permanent && echo 'Run Reload to apply.'"
auto_close_execution = false

[[commands.items]]
name = "Remove Service"
description = "Permanently remove a service."
command = "printf 'Enter service name: '; read -r srv && sudo firewall-cmd --remove-service=\"$srv\" --permanent && echo 'Run Reload to apply.'"
auto_close_execution = false

[[commands.items]]
name = "Remove Port"
description = "Permanently remove a port."
command = "printf 'Enter port/protocol: '; read -r port && sudo firewall-cmd --remove-port=\"$port\" --permanent && echo 'Run Reload to apply.'"
auto_close_execution = false

# ┌─ Zones (B,1) ──────────────────────────────────┐
[[commands]]
name = "🌐 Zones"
col = "B"
row = 1

[[commands.items]]
name = "List All Zones"
command = "sudo firewall-cmd --get-zones"
auto_close_execution = false

[[commands.items]]
name = "Get Active Zones"
command = "sudo firewall-cmd --get-active-zones"
auto_close_execution = false

[[commands.items]]
name = "Change Interface Zone"
description = "Move a network interface to a different zone."
command = "printf 'Enter interface name: '; read -r iface && printf 'Enter new zone: '; read -r zone && sudo firewall-cmd --change-interface=\"$iface\" --zone=\"$zone\""
auto_close_execution = false